**js沙箱隔离就是让子应用之间状态独立，如果所有子应用的沙箱环境都是window，就很容易对全局状态产生污染**

## 如何创建js沙箱运行环境
1. 首先判断是否支持window.Proxy，不支持，则使用SnapshotSanbox，支持则使用LegacySandbox，还有多实例ProxySanbox沙箱。
2. 单实例LegacySandbox使用Proxy对子应用下的window进行封装，记录对全局变量的修改、增加、删除，
3. 在子应用激活时，还原子应用的独立状态池，还原子应用状态。
4. 子应用关闭时，还原沙箱到激活前的状态，清除子应用对主应用的全局污染。
5. 多实例PorxySandbox，也是使用Proxy对window进行代理，有一个updateValueMap集合，在对子应用window更新、设置的时候，都会存储在这个集合中，在获取window下某个属性的时候，会首先到这个集合下获取，若获取不到，再到全局获取。
6. 若不支持Proxy，在子应用激活的时候，会对window变量进行快照，记录激活前的状态，打完快照后，还原到上次沙箱运行环境。在关闭时，记录修改过的快照，然后还原到激活前的状态。